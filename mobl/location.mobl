module mobl::location

import mobl

type Coordinates {
  latitude  : Num
  longitude : Num
  accuracy  : Num
}

external function getPosition(highAccuracy : Bool = false) : Coordinates
external sync function isSupported() : Bool

<javascript>
mobl.location.isSupported = function() {
  return !!navigator.geolocation;
};

mobl.location.getPosition = function(highAccuracy, callback) {
  if(navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      callback({latitude: position.coords.latitude, longitude: position.coords.longitude, accuracy: position.coords.accuracy});
    }, function() {
      callback(null);
    }, {enableHighAccuracy: highAccuracy});
  } else {
    callback(null);
  }
};
</javascript>